import{a2 as N,d as P,B as T,n as o,G as h,q as A,r,o as x,g as I,h as s,e as V,b as n,u as f,w as O,D as z,f as y,y as p,x as G,z as w}from"./index-BgaAjVjm.js";import{u as j}from"./hooks-KDYNtrFv.js";const H=N({name:[{required:!0,message:"角色名称为必填项",trigger:"blur"}],code:[{required:!0,message:"角色标识为必填项",trigger:"blur"}]}),J={class:"w-full pb-2 bg-bg_color overflow-auto"},L={class:"flex flex-wrap"},X=P({__name:"form",props:{formInline:{default:()=>({name:"",status:1,remark:"",menu_ids:[],code:""})},treeMenuData:{default:()=>({treeData:[],treeIds:[],treeSelected:[]})},columns:{default:()=>[]}},setup(D,{expose:R}){const{t:C}=T(),b=D,S={value:"id",label:"title",children:"children"},a=o(),u=o(""),c=o(!1),d=o(!1),i=o(!1),g=o(),v=o(b.formInline),m=o(b.treeMenuData);function K(){var t,e;return v.value.menu_ids=(t=a.value.getCheckedKeys())!=null?t:[],(e=g.value)==null?void 0:e.formInstance}h(c,t=>{t?a.value.setExpandedKeys(m.value.treeIds):a.value.setExpandedKeys([])}),h(d,t=>{t?a.value.setCheckedKeys(m.value.treeIds):a.value.setCheckedKeys([])}),h(u,t=>{a.value.filter(t)});const M=(t,e)=>w(e.title).includes(t);return A(()=>{setTimeout(()=>{a.value.setCheckedKeys(m.value.treeSelected)},0)}),R({getRef:K}),(t,e)=>{const U=r("IconifyIconOffline"),B=r("el-icon"),F=r("el-input"),_=r("el-checkbox"),q=r("el-tree-v2"),E=r("PlusForm");return x(),I(E,{ref_key:"formRef",ref:g,modelValue:v.value,"onUpdate:modelValue":e[4]||(e[4]=l=>v.value=l),columns:t.columns,hasFooter:!1,"row-props":{gutter:24},rules:f(H),"label-position":"right","label-width":"120px"},{"plus-field-menu_ids":s(()=>[V("div",J,[n(F,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=l=>u.value=l),placeholder:f(C)("role.menu_ids"),class:"mb-1",clearable:""},{suffix:s(()=>[n(B,{class:"el-input__icon"},{default:s(()=>[O(n(U,{icon:"ri:search-line"},null,512),[[z,u.value.length===0]])]),_:1})]),_:1},8,["modelValue","placeholder"]),V("div",L,[n(_,{modelValue:c.value,"onUpdate:modelValue":e[1]||(e[1]=l=>c.value=l)},{default:s(()=>[y(p(c.value?"折叠":"展开"),1)]),_:1},8,["modelValue"]),n(_,{modelValue:d.value,"onUpdate:modelValue":e[2]||(e[2]=l=>d.value=l)},{default:s(()=>[y(p(d.value?"全选":"全不选"),1)]),_:1},8,["modelValue"]),n(_,{modelValue:i.value,"onUpdate:modelValue":e[3]||(e[3]=l=>i.value=l)},{default:s(()=>[y(p(i.value?"层级关联":"层级独立"),1)]),_:1},8,["modelValue"])]),n(q,{ref_key:"treeRoleRef",ref:a,"show-checkbox":"",data:m.value.treeData,props:S,"filter-method":M,"check-strictly":!i.value},{default:s(({node:l})=>{var k;return[(x(),I(G(f(j)((k=l==null?void 0:l.data)==null?void 0:k.icon)),{class:"m-1"})),V("span",null,p(f(w)(l.label)),1)]}),_:1},8,["data","check-strictly"])])]),_:1},8,["modelValue","columns","rules"])}}});export{X as _};
